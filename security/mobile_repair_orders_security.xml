<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- ========================================= -->
        <!-- GRUPOS DE SEGURIDAD PERSONALIZADOS       -->
        <!-- ========================================= -->
        
        <record id="group_mobile_repair_manager" model="res.groups">
            <field name="name">Mobile Repair Manager</field>
            <field name="category_id" ref="base.module_category_services"/>
            <field name="comment">Permite gestión completa de las órdenes de reparación móvil</field>
            <field name="implied_ids" eval="[(4, ref('group_mobile_repair_user'))]"/>
        </record>

        <record id="group_mobile_repair_user" model="res.groups">
            <field name="name">Mobile Repair User</field>
            <field name="category_id" ref="base.module_category_services"/>
            <field name="comment">Permite trabajar con órdenes de reparación móvil</field>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA ÓRDENES DE REPARACIÓN      -->
        <!-- ========================================= -->
        
        <record id="access_repair_order_manager" model="ir.model.access">
            <field name="name">repair.order.manager.access</field>
            <field name="model_id" ref="model_mobile_repair_order"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_repair_order_user" model="ir.model.access">
            <field name="name">repair.order.user.access</field>
            <field name="model_id" ref="model_mobile_repair_order"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA DISPOSITIVOS MÓVILES       -->
        <!-- ========================================= -->
        
        <record id="access_mobile_device_manager" model="ir.model.access">
            <field name="name">mobile.device.manager.access</field>
            <field name="model_id" ref="model_mobile_device"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_mobile_device_user" model="ir.model.access">
            <field name="name">mobile.device.user.access</field>
            <field name="model_id" ref="model_mobile_device"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA LÍNEAS DE REPARACIÓN       -->
        <!-- ========================================= -->
        
        <record id="access_repair_line_manager" model="ir.model.access">
            <field name="name">repair.line.manager.access</field>
            <field name="model_id" ref="model_mobile_repair_line"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_repair_line_user" model="ir.model.access">
            <field name="name">repair.line.user.access</field>
            <field name="model_id" ref="model_mobile_repair_line"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA DASHBOARD Y ESTADÍSTICAS   -->
        <!-- ========================================= -->
        
        <record id="access_dashboard_manager" model="ir.model.access">
            <field name="name">dashboard.manager.access</field>
            <field name="model_id" ref="model_mobile_repair_dashboard"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_dashboard_user" model="ir.model.access">
            <field name="name">dashboard.user.access</field>
            <field name="model_id" ref="model_mobile_repair_dashboard"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- Estadísticas de fallas -->
        <record id="access_failure_stats_manager" model="ir.model.access">
            <field name="name">failure.stats.manager.access</field>
            <field name="model_id" ref="model_mobile_repair_failure_stat"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_failure_stats_user" model="ir.model.access">
            <field name="name">failure.stats.user.access</field>
            <field name="model_id" ref="model_mobile_repair_failure_stat"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- Estadísticas de técnicos -->
        <record id="access_technician_stats_manager" model="ir.model.access">
            <field name="name">technician.stats.manager.access</field>
            <field name="model_id" ref="model_mobile_repair_technician_stat"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_technician_stats_user" model="ir.model.access">
            <field name="name">technician.stats.user.access</field>
            <field name="model_id" ref="model_mobile_repair_technician_stat"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA MARCAS - SOLO MANAGERS     -->
        <!-- ========================================= -->
        
        <record id="access_mobile_brand_manager" model="ir.model.access">
            <field name="name">mobile.brand.manager.access</field>
            <field name="model_id" ref="model_mobile_brand"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <!-- Los usuarios pueden VER marcas pero no modificar -->
        <record id="access_mobile_brand_user" model="ir.model.access">
            <field name="name">mobile.brand.user.access</field>
            <field name="model_id" ref="model_mobile_brand"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA MODELOS - SOLO MANAGERS    -->
        <!-- ========================================= -->
        
        <record id="access_mobile_model_manager" model="ir.model.access">
            <field name="name">mobile.model.manager.access</field>
            <field name="model_id" ref="model_mobile_model"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <!-- Los usuarios pueden VER modelos pero no modificar -->
        <record id="access_mobile_model_user" model="ir.model.access">
            <field name="name">mobile.model.user.access</field>
            <field name="model_id" ref="model_mobile_model"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA CATEGORÍAS DE FALLAS       -->
        <!-- ========================================= -->
        
        <record id="access_fault_category_manager" model="ir.model.access">
            <field name="name">fault.category.manager.access</field>
            <field name="model_id" ref="model_mobile_fault_category"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_fault_category_user" model="ir.model.access">
            <field name="name">fault.category.user.access</field>
            <field name="model_id" ref="model_mobile_fault_category"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA FALLAS                     -->
        <!-- ========================================= -->
        
        <record id="access_fault_manager" model="ir.model.access">
            <field name="name">fault.manager.access</field>
            <field name="model_id" ref="model_mobile_fault"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_fault_user" model="ir.model.access">
            <field name="name">fault.user.access</field>
            <field name="model_id" ref="model_mobile_fault"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- PERMISOS PARA CONDICIONES DE DISPOSITIVO -->
        <!-- ========================================= -->
        
        <record id="access_device_condition_manager" model="ir.model.access">
            <field name="name">device.condition.manager.access</field>
            <field name="model_id" ref="model_mobile_device_condition"/>
            <field name="group_id" ref="group_mobile_repair_manager"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <record id="access_device_condition_user" model="ir.model.access">
            <field name="name">device.condition.user.access</field>
            <field name="model_id" ref="model_mobile_device_condition"/>
            <field name="group_id" ref="group_mobile_repair_user"/>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="0"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
        </record>

        <!-- ========================================= -->
        <!-- REGLAS DE SEGURIDAD ADICIONALES          -->
        <!-- ========================================= -->

        <!-- Regla: Los técnicos solo pueden ver sus órdenes asignadas (opcional) -->
        <record id="repair_order_technician_rule" model="ir.rule">
            <field name="name">Técnico: solo órdenes asignadas</field>
            <field name="model_id" ref="model_mobile_repair_order"/>
            <field name="groups" eval="[(4, ref('group_mobile_repair_user'))]"/>
            <field name="domain_force">[('technician_id', '=', user.id)]</field>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="0"/>
            <field name="perm_unlink" eval="0"/>
            <field name="active" eval="False"/>  <!-- Desactivada por defecto -->
        </record>

        <!-- Regla: Los managers pueden ver todas las órdenes -->
        <record id="repair_order_manager_rule" model="ir.rule">
            <field name="name">Manager: todas las órdenes</field>
            <field name="model_id" ref="model_mobile_repair_order"/>
            <field name="groups" eval="[(4, ref('group_mobile_repair_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="1"/>
        </record>

        <!-- Regla: Los usuarios normales pueden ver todas las órdenes (por defecto) -->
        <record id="repair_order_user_all_rule" model="ir.rule">
            <field name="name">Usuario: todas las órdenes</field>
            <field name="model_id" ref="model_mobile_repair_order"/>
            <field name="groups" eval="[(4, ref('group_mobile_repair_user'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
        </record>
    </data>
</odoo>