<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- =============================================
         OPCIÓN 1: Dashboard con Cards Modernas
         Estilo: Minimalista con tarjetas organizadas
         ============================================= -->
    
    <record id="mobile_repair_dashboard_view_cards" model="ir.ui.view">
        <field name="name">mobile.repair.dashboard.cards</field>
        <field name="model">mobile.repair.dashboard</field>
        <field name="arch" type="xml">
            <form string="Dashboard de Reparaciones" create="false" edit="false" class="o_dashboard_view">
                <sheet class="o_dashboard_sheet">
                    
                    <!-- Header con filtros -->
                    <div class="o_dashboard_header mb-4">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="mb-0">
                                    <i class="fa fa-mobile text-primary me-2"/>
                                    Dashboard de Reparaciones
                                </h1>
                                <p class="text-muted mb-0">Vista general del taller en tiempo real</p>
                            </div>
                            <div class="col-md-4 text-end">
                                <button name="action_refresh_data" 
                                        string="Actualizar" 
                                        type="object" 
                                        class="btn btn-outline-primary btn-sm me-2">
                                    <i class="fa fa-refresh"/>
                                </button>
                                <button name="action_create_repair_order" 
                                        string="Nueva Reparación" 
                                        type="object" 
                                        class="btn btn-primary btn-sm">
                                    <i class="fa fa-plus me-1"/>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Filtros de período -->
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="row g-2">
                                    <div class="col">
                                        <field name="date_from" 
                                               class="form-control form-control-sm"
                                               placeholder="Fecha desde"/>
                                    </div>
                                    <div class="col">
                                        <field name="date_to" 
                                               class="form-control form-control-sm"
                                               placeholder="Fecha hasta"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="btn-group btn-group-sm" role="group">
                                    <button name="action_set_current_week" 
                                            string="Esta Semana" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm"/>
                                    <button name="action_set_current_month" 
                                            string="Este Mes" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm"/>
                                    <button name="action_set_last_30_days" 
                                            string="Últimos 30 días" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs principales en cards -->
                    <div class="row g-3 mb-4">
                        <!-- Total Órdenes -->
                        <div class="col-xl-3 col-md-6">
                            <div class="card border-0 shadow-sm h-100" style="cursor: pointer;" 
                                 onclick="this.closest('form').querySelector('[name=action_view_repair_orders]').click()">
                                <div class="card-body text-center">
                                    <div class="d-flex align-items-center justify-content-center mb-3">
                                        <div class="icon-circle bg-primary bg-opacity-10 p-3 rounded-circle">
                                            <i class="fa fa-list-alt fa-2x text-primary"/>
                                        </div>
                                    </div>
                                    <h2 class="fw-bold text-dark mb-1">
                                        <field name="total_orders" readonly="1" nolabel="1"/>
                                    </h2>
                                    <p class="text-muted mb-0">Total de Órdenes</p>
                                    <button name="action_view_repair_orders" 
                                            string="" 
                                            type="object" 
                                            class="d-none"/>
                                </div>
                            </div>
                        </div>
                        
                        <!-- En Reparación -->
                        <div class="col-xl-3 col-md-6">
                            <div class="card border-0 shadow-sm h-100" style="cursor: pointer;"
                                 onclick="this.closest('form').querySelector('[name=action_view_progress_orders]').click()">
                                <div class="card-body text-center">
                                    <div class="d-flex align-items-center justify-content-center mb-3">
                                        <div class="icon-circle bg-warning bg-opacity-10 p-3 rounded-circle">
                                            <i class="fa fa-wrench fa-2x text-warning"/>
                                        </div>
                                    </div>
                                    <h2 class="fw-bold text-dark mb-1">
                                        <field name="orders_in_progress" readonly="1" nolabel="1"/>
                                    </h2>
                                    <p class="text-muted mb-0">En Reparación</p>
                                    <button name="action_view_progress_orders" 
                                            string="" 
                                            type="object" 
                                            class="d-none"/>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Listas para Entrega -->
                        <div class="col-xl-3 col-md-6">
                            <div class="card border-0 shadow-sm h-100" style="cursor: pointer;"
                                 onclick="this.closest('form').querySelector('[name=action_view_ready_orders]').click()">
                                <div class="card-body text-center">
                                    <div class="d-flex align-items-center justify-content-center mb-3">
                                        <div class="icon-circle bg-success bg-opacity-10 p-3 rounded-circle">
                                            <i class="fa fa-check-circle fa-2x text-success"/>
                                        </div>
                                    </div>
                                    <h2 class="fw-bold text-dark mb-1">
                                        <field name="orders_ready" readonly="1" nolabel="1"/>
                                    </h2>
                                    <p class="text-muted mb-0">Listas para Entrega</p>
                                    <button name="action_view_ready_orders" 
                                            string="" 
                                            type="object" 
                                            class="d-none"/>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ingresos Totales -->
                        <div class="col-xl-3 col-md-6">
                            <div class="card border-0 shadow-sm h-100">
                                <div class="card-body text-center">
                                    <div class="d-flex align-items-center justify-content-center mb-3">
                                        <div class="icon-circle bg-info bg-opacity-10 p-3 rounded-circle">
                                            <i class="fa fa-dollar-sign fa-2x text-info"/>
                                        </div>
                                    </div>
                                    <h2 class="fw-bold text-dark mb-1">
                                        <field name="total_revenue" widget="monetary" readonly="1" nolabel="1"/>
                                    </h2>
                                    <p class="text-muted mb-0">Ingresos Totales</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Métricas secundarias -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <div class="card border-0 bg-light">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="fw-bold text-dark mb-1">
                                                <field name="orders_urgent" readonly="1" nolabel="1"/>
                                            </h5>
                                            <small class="text-muted">Órdenes Urgentes</small>
                                        </div>
                                        <button name="action_view_urgent_orders" 
                                                string="Ver" 
                                                type="object" 
                                                class="btn btn-sm btn-outline-danger"
                                                invisible="orders_urgent == 0"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card border-0 bg-light">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="fw-bold text-dark mb-1">
                                                <field name="avg_duration_hours" widget="float_time" readonly="1" nolabel="1"/>
                                            </h5>
                                            <small class="text-muted">Tiempo Promedio</small>
                                        </div>
                                        <i class="fa fa-clock text-muted"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card border-0 bg-light">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h5 class="fw-bold text-dark mb-1">
                                                <field name="completion_rate" readonly="1" nolabel="1"/>%
                                            </h5>
                                            <small class="text-muted">Tasa de Finalización</small>
                                        </div>
                                        <i class="fa fa-chart-line text-muted"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Acciones rápidas -->
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white border-0 pb-0">
                                    <h5 class="card-title mb-0">🚀 Acciones Rápidas</h5>
                                </div>
                                <div class="card-body pt-3">
                                    <div class="d-grid gap-2">
                                        <button name="action_view_draft_orders" 
                                                string="📝 Gestionar Borradores" 
                                                type="object" 
                                                class="btn btn-outline-primary btn-sm text-start"/>
                                        <button name="action_view_pending_invoices" 
                                                string="💰 Pendientes de Facturar" 
                                                type="object" 
                                                class="btn btn-outline-success btn-sm text-start"/>
                                        <button name="action_view_technician_workload" 
                                                string="👷 Carga por Técnico" 
                                                type="object" 
                                                class="btn btn-outline-info btn-sm text-start"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white border-0 pb-0">
                                    <h5 class="card-title mb-0">📊 Análisis</h5>
                                </div>
                                <div class="card-body pt-3">
                                    <div class="mb-3">
                                        <label class="form-label text-muted small">Falla Más Común</label>
                                        <p class="fw-bold mb-2">
                                            <field name="most_common_failure" readonly="1" nolabel="1"/>
                                        </p>
                                    </div>
                                    <div>
                                        <label class="form-label text-muted small">Técnico Más Ocupado</label>
                                        <p class="fw-bold mb-0">
                                            <field name="busiest_technician" readonly="1" nolabel="1"/>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campo oculto para moneda -->
                    <field name="currency_id" invisible="1"/>
                    
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- =============================================
         OPCIÓN 2: Dashboard Estilo Kanban/Tiles
         Estilo: Tiles grandes con métricas destacadas
         ============================================= -->
    
    <record id="mobile_repair_dashboard_view_tiles" model="ir.ui.view">
        <field name="name">mobile.repair.dashboard.tiles</field>
        <field name="model">mobile.repair.dashboard</field>
        <field name="arch" type="xml">
            <form string="Dashboard de Reparaciones" create="false" edit="false" class="o_dashboard_view">
                <sheet class="o_dashboard_sheet">
                    
                    <!-- Header compacto -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h1 class="mb-1">
                                <i class="fa fa-mobile text-primary me-2"/>
                                Dashboard de Reparaciones
                            </h1>
                            <div class="d-flex gap-2 align-items-center">
                                <field name="date_from" class="form-control form-control-sm d-inline" style="width: auto;"/>
                                <span class="text-muted">-</span>
                                <field name="date_to" class="form-control form-control-sm d-inline" style="width: auto;"/>
                                <button name="action_refresh_data" 
                                        string="🔄" 
                                        type="object" 
                                        class="btn btn-outline-secondary btn-sm ms-2"
                                        title="Actualizar datos"/>
                            </div>
                        </div>
                        <button name="action_create_repair_order" 
                                string="+ Nueva Reparación" 
                                type="object" 
                                class="btn btn-primary"/>
                    </div>
                    
                    <!-- Grid principal de métricas -->
                    <div class="o_dashboard_tiles">
                        
                        <!-- Fila 1: Métricas principales -->
                        <div class="row g-4 mb-4">
                            
                            <!-- Tile: Total Órdenes -->
                            <div class="col-lg-3 col-md-6">
                                <div class="o_tile o_tile_primary h-100" 
                                     style="cursor: pointer; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"
                                     onclick="this.closest('form').querySelector('[name=action_view_repair_orders]').click()">
                                    <div class="o_tile_body text-white p-4">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="o_tile_value display-4 fw-bold mb-0">
                                                    <field name="total_orders" readonly="1" nolabel="1"/>
                                                </div>
                                                <div class="o_tile_label fs-6 opacity-90">Total de Órdenes</div>
                                            </div>
                                            <i class="fa fa-list-alt fa-2x opacity-75"/>
                                        </div>
                                        <div class="mt-3 small opacity-75">
                                            📊 Ver detalles completos
                                        </div>
                                    </div>
                                    <button name="action_view_repair_orders" string="" type="object" class="d-none"/>
                                </div>
                            </div>
                            
                            <!-- Tile: En Proceso -->
                            <div class="col-lg-3 col-md-6">
                                <div class="o_tile o_tile_warning h-100" 
                                     style="cursor: pointer; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"
                                     onclick="this.closest('form').querySelector('[name=action_view_progress_orders]').click()">
                                    <div class="o_tile_body text-white p-4">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="o_tile_value display-4 fw-bold mb-0">
                                                    <field name="orders_in_progress" readonly="1" nolabel="1"/>
                                                </div>
                                                <div class="o_tile_label fs-6 opacity-90">En Reparación</div>
                                            </div>
                                            <i class="fa fa-wrench fa-2x opacity-75"/>
                                        </div>
                                        <div class="mt-3 small opacity-75">
                                            🔧 Gestionar trabajo activo
                                        </div>
                                    </div>
                                    <button name="action_view_progress_orders" string="" type="object" class="d-none"/>
                                </div>
                            </div>
                            
                            <!-- Tile: Completadas -->
                            <div class="col-lg-3 col-md-6">
                                <div class="o_tile o_tile_success h-100" 
                                     style="cursor: pointer; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"
                                     onclick="this.closest('form').querySelector('[name=action_view_ready_orders]').click()">
                                    <div class="o_tile_body text-white p-4">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="o_tile_value display-4 fw-bold mb-0">
                                                    <field name="orders_ready" readonly="1" nolabel="1"/>
                                                </div>
                                                <div class="o_tile_label fs-6 opacity-90">Listas para Entrega</div>
                                            </div>
                                            <i class="fa fa-check-circle fa-2x opacity-75"/>
                                        </div>
                                        <div class="mt-3 small opacity-75">
                                            ✅ Facturar y entregar
                                        </div>
                                    </div>
                                    <button name="action_view_ready_orders" string="" type="object" class="d-none"/>
                                </div>
                            </div>
                            
                            <!-- Tile: Ingresos -->
                            <div class="col-lg-3 col-md-6">
                                <div class="o_tile o_tile_info h-100" 
                                     style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #2c3e50;">
                                    <div class="o_tile_body p-4">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="o_tile_value display-6 fw-bold mb-0 text-dark">
                                                    <field name="total_revenue" widget="monetary" readonly="1" nolabel="1"/>
                                                </div>
                                                <div class="o_tile_label fs-6 text-muted">Ingresos Totales</div>
                                            </div>
                                            <i class="fa fa-dollar-sign fa-2x text-success"/>
                                        </div>
                                        <div class="mt-3 small text-muted">
                                            💰 Valor promedio: <field name="avg_order_value" widget="monetary" readonly="1" nolabel="1"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                        <!-- Fila 2: Métricas secundarias -->
                        <div class="row g-3 mb-4">
                            
                            <div class="col-md-3">
                                <div class="card border-0 bg-warning bg-opacity-10 h-100" 
                                     style="cursor: pointer;"
                                     onclick="this.closest('form').querySelector('[name=action_view_urgent_orders]').click()">
                                    <div class="card-body text-center">
                                        <h3 class="text-warning mb-1">
                                            <field name="orders_urgent" readonly="1" nolabel="1"/>
                                        </h3>
                                        <small class="text-muted">🚨 Urgentes</small>
                                    </div>
                                    <button name="action_view_urgent_orders" string="" type="object" class="d-none"/>
                                </div>
                            </div>
                            
                            <div class="col-md-3">
                                <div class="card border-0 bg-info bg-opacity-10 h-100">
                                    <div class="card-body text-center">
                                        <h3 class="text-info mb-1">
                                            <field name="avg_duration_hours" widget="float_time" readonly="1" nolabel="1"/>
                                        </h3>
                                        <small class="text-muted">⏱️ Tiempo Promedio</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-3">
                                <div class="card border-0 bg-success bg-opacity-10 h-100">
                                    <div class="card-body text-center">
                                        <h3 class="text-success mb-1">
                                            <field name="completion_rate" readonly="1" nolabel="1"/>%
                                        </h3>
                                        <small class="text-muted">📈 Tasa Finalización</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-3">
                                <div class="card border-0 bg-primary bg-opacity-10 h-100"
                                     style="cursor: pointer;"
                                     onclick="this.closest('form').querySelector('[name=action_view_pending_invoices]').click()">
                                    <div class="card-body text-center">
                                        <h3 class="text-primary mb-1">
                                            <field name="pending_revenue" widget="monetary" readonly="1" nolabel="1"/>
                                        </h3>
                                        <small class="text-muted">💳 Por Facturar</small>
                                    </div>
                                    <button name="action_view_pending_invoices" string="" type="object" class="d-none"/>
                                </div>
                            </div>
                            
                        </div>
                        
                    </div>
                    
                    <!-- Información contextual -->
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <h6 class="card-title text-muted mb-3">📊 Análisis del Período</h6>
                                    <div class="mb-2">
                                        <strong>Falla más común:</strong>
                                        <br/><span class="text-primary"><field name="most_common_failure" readonly="1" nolabel="1"/></span>
                                    </div>
                                    <div>
                                        <strong>Técnico más ocupado:</strong>
                                        <br/><span class="text-info"><field name="busiest_technician" readonly="1" nolabel="1"/></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <h6 class="card-title text-muted mb-3">🚀 Acciones Rápidas</h6>
                                    <div class="d-grid gap-2">
                                        <button name="action_view_technician_workload" 
                                                string="👷 Ver Carga de Trabajo" 
                                                type="object" 
                                                class="btn btn-outline-primary btn-sm"/>
                                        <button name="action_view_draft_orders" 
                                                string="📝 Gestionar Borradores" 
                                                type="object" 
                                                class="btn btn-outline-secondary btn-sm"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campos ocultos -->
                    <field name="currency_id" invisible="1"/>
                    
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- =============================================
         OPCIÓN 3: Dashboard Compacto/Ejecutivo
         Estilo: Información densa, ideal para móviles
         ============================================= -->
    
    <record id="mobile_repair_dashboard_view_compact" model="ir.ui.view">
        <field name="name">mobile.repair.dashboard.compact</field>
        <field name="model">mobile.repair.dashboard</field>
        <field name="arch" type="xml">
            <form string="Dashboard Reparaciones" create="false" edit="false" class="o_dashboard_view">
                <sheet class="o_dashboard_sheet">
                    
                    <!-- Header ultra compacto -->
                    <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
                        <h2 class="mb-0">
                            <i class="fa fa-mobile text-primary me-2"/>
                            Dashboard Reparaciones
                        </h2>
                        <div class="d-flex gap-2">
                            <button name="action_refresh_data" 
                                    string="🔄" 
                                    type="object" 
                                    class="btn btn-sm btn-outline-secondary"
                                    title="Actualizar"/>
                            <button name="action_create_repair_order" 
                                    string="+" 
                                    type="object" 
                                    class="btn btn-sm btn-primary"
                                    title="Nueva Reparación"/>
                        </div>
                    </div>
                    
                    <!-- Filtros inline -->
                    <div class="row g-2 mb-4">
                        <div class="col-md-4">
                            <div class="input-group input-group-sm">
                                <span class="input-group-text">Desde</span>
                                <field name="date_from" class="form-control"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="input-group input-group-sm">
                                <span class="input-group-text">Hasta</span>
                                <field name="date_to" class="form-control"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="btn-group btn-group-sm w-100" role="group">
                                <button name="action_set_current_week" 
                                        string="Semana" 
                                        type="object" 
                                        class="btn btn-outline-secondary"/>
                                <button name="action_set_current_month" 
                                        string="Mes" 
                                        type="object" 
                                        class="btn btn-outline-secondary"/>
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs en formato tabla compacta -->
                    <div class="table-responsive mb-4">
                        <table class="table table-borderless">
                            <tbody>
                                <!-- Fila 1: Métricas principales -->
                                <tr>
                                    <td class="text-center p-3 bg-primary bg-opacity-10 rounded" 
                                        style="cursor: pointer;"
                                        onclick="this.closest('form').querySelector('[name=action_view_repair_orders]').click()">
                                        <div class="fw-bold h4 text-primary mb-1">
                                            <field name="total_orders" readonly="1" nolabel="1"/>
                                        </div>
                                        <small class="text-muted">Total Órdenes</small>
                                        <button name="action_view_repair_orders" string="" type="object" class="d-none"/>
                                    </td>
                                    <td class="text-center p-3 bg-warning bg-opacity-10 rounded"
                                        style="cursor: pointer;"
                                        onclick="this.closest('form').querySelector('[name=action_view_progress_orders]').click()">
                                        <div class="fw-bold h4 text-warning mb-1">
                                            <field name="orders_in_progress" readonly="1" nolabel="1"/>
                                        </div>
                                        <small class="text-muted">En Proceso</small>
                                        <button name="action_view_progress_orders" string="" type="object" class="d-none"/>
                                    </td>
                                    <td class="text-center p-3 bg-success bg-opacity-10 rounded"