<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Dashboard mejorado y completo -->
    <record id="repair_dashboard_view" model="ir.ui.view">
        <field name="name">mobile.repair.dashboard.form</field>
        <field name="model">mobile.repair.dashboard</field>
        <field name="arch" type="xml">
            <form string="Dashboard de Reparaciones" create="false" edit="false">
                <sheet>
                    
                    <!-- HEADER CON T√çTULO Y PERIODO -->
                    <div class="oe_title mb16">
                        <h1>
                            <span class="fa fa-mobile mr8" style="color: #17a2b8;"/>
                            Dashboard de Reparaciones M√≥viles
                        </h1>
                        <h3 style="color: #6c757d;">Vista general del negocio en tiempo real</h3>
                    </div>
                    
                    <!-- FILTROS Y CONTROLES -->
                    <group string="üìÖ Per√≠odo de An√°lisis" name="filters">
                        <group>
                            <field name="date_from" string="Desde"/>
                            <field name="date_to" string="Hasta"/>
                        </group>
                        <group>
                            <button name="action_refresh_data" 
                                    string="üîÑ Actualizar Datos" 
                                    type="object" 
                                    class="btn-primary"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                    </group>

                    <!-- KPIs PRINCIPALES -->
                    <group string="üìä Indicadores Clave de Rendimiento" name="main_kpis">
                        <group string="üìã Volumen de Trabajo" name="volume_kpis">
                            <field name="total_orders" readonly="1" 
                                   widget="statinfo" 
                                   string="Total de √ìrdenes"/>
                            <field name="orders_in_progress" readonly="1" 
                                   widget="statinfo" 
                                   string="En Proceso"/>
                        </group>
                        
                        <group string="üí∞ Rendimiento Financiero" name="financial_kpis">
                            <field name="total_revenue" readonly="1" 
                                   widget="monetary" 
                                   string="Ingresos Totales"/>
                            <field name="avg_order_value" readonly="1" 
                                   widget="monetary" 
                                   string="Valor Promedio/Orden"/>
                        </group>
                        
                        <group string="‚è±Ô∏è Eficiencia Operacional" name="operational_kpis">
                            <field name="avg_duration_hours" readonly="1" 
                                   string="Tiempo Promedio (hrs)"/>
                            <field name="orders_completed" readonly="1" 
                                   widget="statinfo" 
                                   string="Completadas"/>
                        </group>
                    </group>

                    <!-- DISTRIBUCI√ìN POR ESTADOS -->
                    <group string="üì± Distribuci√≥n de √ìrdenes por Estado" name="status_distribution">
                        <group string="üìù En Preparaci√≥n">
                            <field name="orders_draft" readonly="1" 
                                   string="Borradores"/>
                        </group>
                        
                        <group string="üîß En Ejecuci√≥n">
                            <field name="orders_in_progress" readonly="1" 
                                   string="En Proceso"/>
                        </group>
                        
                        <group string="‚úÖ Finalizadas">
                            <field name="orders_completed" readonly="1" 
                                   string="Completadas"/>
                        </group>
                        
                        <group string="‚ùå No Completadas">
                            <field name="orders_canceled" readonly="1" 
                                   string="Canceladas"/>
                        </group>
                    </group>

                    <!-- AN√ÅLISIS DE FALLAS -->
                    <group string="üîç An√°lisis de Diagn√≥sticos" name="failure_analysis">
                        <field name="most_common_failure" readonly="1" 
                               string="Falla M√°s Frecuente"/>
                    </group>

                    <!-- NAVEGACI√ìN R√ÅPIDA - SECCI√ìN PRINCIPAL -->
                    <group string="üöÄ Navegaci√≥n R√°pida" name="quick_navigation">
                        <div class="row">
                            
                            <!-- Columna 1: Gesti√≥n de √ìrdenes -->
                            <div class="col-md-4">
                                <h4>üìã Gesti√≥n de √ìrdenes</h4>
                                <p>
                                    <button name="action_view_repair_orders" 
                                            string="üîç Ver Todas las √ìrdenes" 
                                            type="object" 
                                            class="btn btn-primary btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_draft_orders" 
                                            string="üìù Borradores" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm mr8 mb8"/>
                                    
                                    <button name="action_view_progress_orders" 
                                            string="üîß En Proceso" 
                                            type="object" 
                                            class="btn btn-warning btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_completed_orders" 
                                            string="‚úÖ Completadas" 
                                            type="object" 
                                            class="btn btn-success btn-sm mr8 mb8"/>
                                </p>
                            </div>
                            
                            <!-- Columna 2: Acciones R√°pidas -->
                            <div class="col-md-4">
                                <h4>‚ö° Acciones R√°pidas</h4>
                                <p>
                                    <button name="action_create_repair_order" 
                                            string="‚ûï Nueva Orden" 
                                            type="object" 
                                            class="btn btn-primary btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_urgent_orders" 
                                            string="üö® √ìrdenes Urgentes" 
                                            type="object" 
                                            class="btn btn-danger btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_this_week_orders" 
                                            string="üìÖ Esta Semana" 
                                            type="object" 
                                            class="btn btn-info btn-sm mr8 mb8"/>
                                </p>
                            </div>
                            
                            <!-- Columna 3: Configuraci√≥n -->
                            <div class="col-md-4">
                                <h4>‚öôÔ∏è Configuraci√≥n</h4>
                                <p>
                                    <button name="action_view_devices" 
                                            string="üì± Dispositivos" 
                                            type="object" 
                                            class="btn btn-outline-primary btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_fault_categories" 
                                            string="üìÇ Categor√≠as Fallas" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm mr8 mb8"/>
                                </p>
                                <p>
                                    <button name="action_view_faults" 
                                            string="‚ö†Ô∏è Tipos de Fallas" 
                                            type="object" 
                                            class="btn btn-outline-secondary btn-sm mr8 mb8"/>
                                </p>
                            </div>
                            
                        </div>
                    </group>

                    <!-- RESUMEN VISUAL ADICIONAL -->
                    <group string="üìà Resumen Visual" name="visual_summary">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="alert alert-info" role="alert">
                                    <h5 class="alert-heading">üí° Resumen del Per√≠odo</h5>
                                    <p class="mb-0">
                                        ‚Ä¢ <strong><field name="total_orders" readonly="1" nolabel="1"/></strong> √≥rdenes procesadas<br/>
                                        ‚Ä¢ <strong><field name="total_revenue" readonly="1" widget="monetary" nolabel="1"/></strong> en ingresos<br/>
                                        ‚Ä¢ Tiempo promedio: <strong><field name="avg_duration_hours" readonly="1" nolabel="1"/> horas</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-success" role="alert">
                                    <h5 class="alert-heading">üéØ Estado Actual</h5>
                                    <p class="mb-0">
                                        ‚Ä¢ <strong><field name="orders_in_progress" readonly="1" nolabel="1"/></strong> √≥rdenes en proceso<br/>
                                        ‚Ä¢ <strong><field name="orders_completed" readonly="1" nolabel="1"/></strong> √≥rdenes completadas<br/>
                                        ‚Ä¢ Falla com√∫n: <strong><field name="most_common_failure" readonly="1" nolabel="1"/></strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </group>

                </sheet>
            </form>
        </field>
    </record>

    <!-- Acci√≥n de ventana simple y funcional -->
    <record id="action_mobile_repair_dashboard" model="ir.actions.act_window">
        <field name="name">Dashboard de Reparaciones</field>
        <field name="res_model">mobile.repair.dashboard</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="context">{}</field>
    </record>

</odoo>